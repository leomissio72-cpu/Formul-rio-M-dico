// === Envio dos dados (Código OTIMIZADO) ===
    form.addEventListener("submit", e => {
      e.preventDefault();
      
      const submitButton = e.submitter; // Pega o botão de envio
      submitButton.disabled = true; // Desabilita para evitar cliques duplos
      submitButton.textContent = "Aguarde...";

      const formData = new FormData(form);
      formData.append("dataEnvio", new Date().toLocaleString("pt-BR")); // Adiciona a data de envio

      fetch(scriptURL, { method: "POST", body: formData })
        .then(response => {
            if (!response.ok) {
                // Se a resposta HTTP for um erro (ex: 500), lança um erro
                throw new Error(`Erro HTTP: ${response.status}`);
            }
            return response.text(); // Lê a resposta como texto
        })
        .then(responseText => {
            if (responseText === "OK") {
                alert("✅ Enviado com sucesso!");
                form.reset();
            } else {
                // Captura a mensagem de erro do Apps Script (ex: "Erro: Permissão negada")
                alert(`❌ Erro no Script: ${responseText}`);
            }
        })
        .catch(error => {
            alert(`❌ Falha de Envio: ${error.message}. Verifique o URL do Script e a Planilha.`);
        })
        .finally(() => {
            submitButton.disabled = false; // Reabilita o botão
            submitButton.textContent = "Enviar";
        });
    });
